<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google OAuth Demo</title>
    <script src="https://apis.google.com/js/api.js"></script>
</head>
<body>
    <button id="login-button">Login with Google</button>
    <button id="logout-button" style="display: none;">Logout</button>
    <div id="content"></div>

    <script>
        const CLIENT_ID = '812194722245-3cinf55qaia7jlftpuoo9kco7dtetmbf.apps.googleusercontent.com'; // Replace with your client ID
        const SCOPE = 'https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/spreadsheets';
        let GoogleAuth;

        function handleClientLoad() {
            gapi.load('client:auth2', initClient);
        }

        function initClient() {
            gapi.client.init({
                clientId: CLIENT_ID,
                scope: SCOPE,
            }).then(function () {
                GoogleAuth = gapi.auth2.getAuthInstance();
                GoogleAuth.isSignedIn.listen(updateSigninStatus);
                updateSigninStatus(GoogleAuth.isSignedIn.get());

                document.getElementById('login-button').onclick = handleAuthClick;
                document.getElementById('logout-button').onclick = handleSignoutClick;
            });
        }

        function updateSigninStatus(isSignedIn) {
            if (isSignedIn) {
                document.getElementById('login-button').style.display = 'none';
                document.getElementById('logout-button').style.display = 'block';
                listFiles();
            } else {
                document.getElementById('login-button').style.display = 'block';
                document.getElementById('logout-button').style.display = 'none';
            }
        }

        function handleAuthClick(event) {
            GoogleAuth.signIn().then(function () {
                const user = GoogleAuth.currentUser.get();
                const token = user.getAuthResponse().id_token;
                localStorage.setItem('google_token', token);
                updateSigninStatus(true);
            });
        }

        function handleSignoutClick(event) {
            GoogleAuth.signOut().then(function () {
                localStorage.removeItem('google_token');
                updateSigninStatus(false);
            });
        }

        function listFiles() {
            gapi.client.drive.files.list({
                'pageSize': 10,
                'fields': "nextPageToken, files(id, name)"
            }).then(function(response) {
                const files = response.result.files;
                if (files && files.length > 0) {
                    let output = '<ul>';
                    files.forEach(file => {
                        output += `<li>${file.name}</li>`;
                    });
                    output += '</ul>';
                    document.getElementById('content').innerHTML = output;
                } else {
                    document.getElementById('content').innerHTML = 'No files found.';
                }
            });
        }

        document.addEventListener('DOMContentLoaded', handleClientLoad);
    </script>
</body>
</html>
